# Type Generation Approach

## Phase 1: Schema-to-JSON Bridge (Go + Node.js)

### Step 1: Extract Schema Definitions
```bash
# Use Node.js for TypeScript parsing (reliable, mature)
node extract-schemas.js -> schemas.json
```

### Step 2: Generate Types in Go
```bash
# Use Go for fast template-based generation
go run generate.go schemas.json -> generated/types.ts
```

### Workflow:
```
*.monko.ts files → Node.js parser → JSON → Go generator → TypeScript types
```

## Benefits:
- **Reliable**: Uses mature TypeScript parsing
- **Fast**: Go handles the generation
- **Simple**: Clear separation of concerns
- **Future-proof**: Easy to replace Node.js part with TypeScript-Go later

## Example Schema Extraction:

```typescript
// User.monko.ts
export const User = defineSchema({
  name: "User",
  db: "myapp",
  collection: "users",
  fields: {
    name: fields.string({ required: true }),
    email: fields.string({ required: true, unique: true })
  },
  options: { timestamps: true }
});
```

```json
// schemas.json (extracted)
{
  "schemas": [
    {
      "name": "User",
      "db": "myapp", 
      "collection": "users",
      "fields": {
        "name": { "type": "string", "required": true },
        "email": { "type": "string", "required": true, "unique": true }
      },
      "options": { "timestamps": true }
    }
  ]
}
```

```typescript
// generated/User.types.ts (generated by Go)
import type { ObjectId } from 'mongodb';

export type UserDocument = {
  _id: ObjectId;
  name: string;
  email: string;
  createdAt: Date;
  updatedAt: Date;
}
```

## Phase 2: Pure Go (Future)
When TypeScript-Go matures:
- Replace Node.js extraction with pure Go
- Single binary, zero dependencies
- Even faster generation 